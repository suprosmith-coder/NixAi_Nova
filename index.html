<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CYANIX | Quantum AI Platform</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Montserrat:wght@300;400;500;600;700;800&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* Base Colors */
            --synix-bg: linear-gradient(135deg, #0a0118 0%, #1a0b2e 50%, #120229 100%);
            --synix-primary: #9d4edd;
            --synix-secondary: #7d00ff;
            --synix-accent: #c77dff;
            --synix-glow: 0 0 30px rgba(157, 78, 221, 0.7), 0 0 60px rgba(157, 78, 221, 0.3);
            --synix-grid: rgba(157, 78, 221, 0.1);
            --synix-border: rgba(157, 78, 221, 0.3);
            --synix-text: #e0c3ff;
            
            --axion-bg: linear-gradient(135deg, #00111a 0%, #002233 50%, #003344 100%);
            --axion-primary: #00f3ff;
            --axion-secondary: #00a8b5;
            --axion-accent: #6bffff;
            --axion-glow: 0 0 40px rgba(0, 243, 255, 0.8), 0 0 80px rgba(0, 243, 255, 0.4);
            --axion-grid: rgba(0, 243, 255, 0.15);
            --axion-border: rgba(0, 243, 255, 0.4);
            --axion-text: #b3ffff;
            
            --supernix-bg: linear-gradient(135deg, #000814 0%, #001d3d 50%, #003566 100%);
            --supernix-primary: #4361ee;
            --supernix-secondary: #3a0ca3;
            --supernix-accent: #4cc9f0;
            --supernix-glow: 0 0 50px rgba(67, 97, 238, 0.9), 0 0 100px rgba(67, 97, 238, 0.5);
            --supernix-grid: rgba(67, 97, 238, 0.2);
            --supernix-border: rgba(67, 97, 238, 0.5);
            --supernix-text: #a8d0ff;
            
            /* Current Theme */
            --bg-primary: var(--synix-bg);
            --primary-color: var(--synix-primary);
            --secondary-color: var(--synix-secondary);
            --accent-color: var(--synix-accent);
            --neon-glow: var(--synix-glow);
            --grid-color: var(--synix-grid);
            --border-color: var(--synix-border);
            --text-color: var(--synix-text);
            
            /* UI Variables */
            --card-bg: rgba(255, 255, 255, 0.05);
            --input-bg: rgba(255, 255, 255, 0.08);
            --hover-bg: rgba(255, 255, 255, 0.12);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --dark-bg: rgba(0, 0, 0, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--bg-primary);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Quantum Grid Background */
        .quantum-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 60px 60px;
            z-index: -3;
            opacity: 0.4;
            animation: gridFlow 40s linear infinite;
        }

        /* Neural Network Lines */
        .neural-network {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            opacity: 0.1;
            pointer-events: none;
        }

        .neural-line {
            position: absolute;
            background: var(--primary-color);
            transform-origin: left;
            animation: neuralPulse 4s infinite ease-in-out;
        }

        /* Particle System */
        .particle-system {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--primary-color);
            box-shadow: 0 0 10px var(--primary-color);
            animation: particleFloat 15s infinite linear;
        }

        /* Holographic Effects */
        .hologram-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(0deg, transparent 50%, rgba(var(--primary-rgb), 0.02) 50%);
            background-size: 100% 4px;
            z-index: -1;
            opacity: 0.3;
            pointer-events: none;
        }

        /* Auth Container */
        .auth-container {
            min-height: 100vh;
            display: flex;
            opacity: 1;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .auth-left {
            flex: 1;
            background: rgba(10, 1, 24, 0.85);
            padding: 80px 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            backdrop-filter: blur(30px);
            border-right: 1px solid var(--border-color);
        }

        .auth-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 60%, rgba(var(--primary-rgb), 0.1) 100%);
            pointer-events: none;
        }

        .auth-right {
            flex: 1;
            background: rgba(21, 21, 32, 0.5);
            padding: 80px 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            backdrop-filter: blur(30px);
            position: relative;
        }

        /* Logo */
        .logo {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 60px;
            animation: slideInLeft 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            box-shadow: var(--neon-glow);
            position: relative;
            animation: pulse 3s infinite alternate;
        }

        .logo-icon::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            border: 3px solid transparent;
            background: linear-gradient(135deg, var(--primary-color), transparent) border-box;
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: rotate 10s linear infinite;
        }

        .logo-text {
            font-size: 48px;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
            text-shadow: 0 0 30px rgba(var(--primary-rgb), 0.5);
        }

        /* Auth Content */
        .auth-title {
            font-size: 64px;
            font-weight: 900;
            margin-bottom: 20px;
            line-height: 1.1;
            font-family: 'Orbitron', sans-serif;
            animation: slideInLeft 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.1s both;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
        }

        .auth-subtitle {
            font-size: 22px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 50px;
            line-height: 1.6;
            animation: slideInLeft 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
            font-weight: 300;
            max-width: 600px;
        }

        /* Model Cards */
        .model-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 40px;
            animation: slideInLeft 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.3s both;
        }

        .model-card {
            padding: 25px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            backdrop-filter: blur(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .model-card:hover {
            transform: translateY(-10px) scale(1.05);
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
        }

        .model-card.active {
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(var(--primary-rgb), 0.15);
        }

        .model-icon {
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--primary-color);
            text-shadow: 0 0 20px var(--primary-color);
        }

        .model-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
            font-family: 'Orbitron', sans-serif;
        }

        .model-desc {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Auth Forms */
        .auth-form {
            max-width: 440px;
            margin: 0 auto;
            width: 100%;
            animation: slideInRight 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .auth-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
        }

        .auth-tab-indicator {
            position: absolute;
            width: 50%;
            height: calc(100% - 16px);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            top: 8px;
            left: 8px;
            border-radius: 12px;
            box-shadow: var(--neon-glow);
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 1;
        }

        .auth-tab {
            flex: 1;
            padding: 18px;
            text-align: center;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 2;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .auth-tab.active {
            color: var(--white);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 30px;
            animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-color);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .form-input {
            width: 100%;
            padding: 20px;
            background: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: 14px;
            font-size: 16px;
            color: var(--white);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Montserrat', sans-serif;
            backdrop-filter: blur(20px);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .password-wrapper {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            padding: 5px;
        }

        /* Auth Buttons */
        .auth-btn {
            width: 100%;
            padding: 22px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            border: none;
            border-radius: 14px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 30px;
            box-shadow: var(--neon-glow);
            position: relative;
            overflow: hidden;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .auth-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 0 40px var(--primary-color), 0 0 80px rgba(var(--primary-rgb), 0.4);
        }

        /* Chat Container */
        .chat-container {
            display: none;
            height: 100vh;
            opacity: 0;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .chat-container.active {
            display: block;
            opacity: 1;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 320px;
            height: 100%;
            background: rgba(10, 1, 24, 0.9);
            border-right: 2px solid var(--border-color);
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(30px);
            z-index: 100;
            transform: translateX(-100%);
            animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.3s;
        }

        /* Main Chat */
        .main-chat {
            margin-left: 320px;
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 0;
            animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.5s;
        }

        /* Chat Header */
        .chat-header {
            padding: 25px 30px;
            background: rgba(10, 1, 24, 0.9);
            border-bottom: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            backdrop-filter: blur(30px);
        }

        /* Messages */
        .message {
            max-width: 850px;
            margin: 0 auto 35px;
            padding: 30px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 24px;
            animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
        }

        /* Input Container */
        .input-container {
            padding: 30px;
            background: rgba(10, 1, 24, 0.9);
            border-top: 2px solid var(--border-color);
            backdrop-filter: blur(30px);
        }

        /* Model Transition Animation */
        .model-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            animation: modelTransition 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modelTransition {
            0% {
                opacity: 0;
                transform: scale(1);
            }
            20% {
                opacity: 1;
                transform: scale(1.1);
            }
            80% {
                opacity: 1;
                transform: scale(1.1);
            }
            100% {
                opacity: 0;
                transform: scale(1);
            }
        }

        @keyframes gridFlow {
            0% { background-position: 0 0; }
            100% { background-position: 60px 60px; }
        }

        @keyframes neuralPulse {
            0%, 100% { opacity: 0.1; transform: scaleX(0); }
            50% { opacity: 0.3; transform: scaleX(1); }
        }

        @keyframes particleFloat {
            0% { transform: translateY(100vh) translateX(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.5; }
            90% { opacity: 0.5; }
            100% { transform: translateY(-100px) translateX(100px) rotate(360deg); opacity: 0; }
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: var(--neon-glow); }
            100% { transform: scale(1.05); box-shadow: 0 0 40px var(--primary-color), 0 0 80px rgba(var(--primary-rgb), 0.4); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .model-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .auth-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-chat {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="quantum-grid"></div>
    <div class="neural-network" id="neuralNetwork"></div>
    <div class="particle-system" id="particleSystem"></div>
    <div class="hologram-overlay"></div>

    <!-- Model Transition Overlay -->
    <div class="model-transition" id="modelTransition"></div>

    <!-- Auth Container -->
    <div id="authContainer" class="auth-container">
        <div class="auth-left">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="logo-text">CYANIX</div>
            </div>
            
            <h1 class="auth-title">Quantum Neural Interface</h1>
            <p class="auth-subtitle">Experience ultra-realistic AI interaction with three distinct neural architectures, each optimized for specific cognitive processing paradigms.</p>
            
            <div class="model-cards">
                <div class="model-card active" onclick="previewModel('Synix')">
                    <div class="model-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="model-name">SYNIX</div>
                    <div class="model-desc">Purple & Black - Balanced Intelligence</div>
                </div>
                <div class="model-card" onclick="previewModel('Axion')">
                    <div class="model-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="model-name">AXION</div>
                    <div class="model-desc">Cyan - Advanced Processing</div>
                </div>
                <div class="model-card" onclick="previewModel('SuperNix')">
                    <div class="model-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div class="model-name">SUPERNIX</div>
                    <div class="model-desc">Dark Blue & Black - Quantum Premium</div>
                </div>
            </div>
        </div>
        
        <div class="auth-right">
            <div class="auth-form" id="authForm">
                <div class="auth-tabs" id="authTabs">
                    <div class="auth-tab-indicator"></div>
                    <button class="auth-tab active" onclick="switchAuthTab('signin')">NEURAL SIGN IN</button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')">NEURAL SIGN UP</button>
                </div>
                
                <!-- Sign In Form -->
                <div id="signinForm" class="auth-form-content">
                    <div class="form-group">
                        <label class="form-label">NEURAL EMAIL</label>
                        <input type="email" id="signinEmail" class="form-input" placeholder="Enter neural email address">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">NEURAL PASSWORD</label>
                        <div class="password-wrapper">
                            <input type="password" id="signinPassword" class="form-input" placeholder="Enter neural password">
                            <button class="password-toggle" type="button" onclick="togglePassword('signinPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="remember-me">
                            <input type="checkbox" id="rememberMe" class="checkbox">
                            <span>Maintain Neural Connection</span>
                        </label>
                        <a href="#" class="forgot-password" onclick="showForgotPassword()">Forgot Neural Key?</a>
                    </div>
                    
                    <button class="auth-btn" onclick="signInWithEmail()">
                        <i class="fas fa-sign-in-alt"></i>
                        INITIATE NEURAL LINK
                    </button>
                    
                    <div class="auth-divider">
                        <span>OR CONNECT WITH</span>
                    </div>
                    
                    <div class="social-auth">
                        <button class="social-btn google-btn" onclick="signInWithGoogle()">
                            <i class="fab fa-google social-icon"></i>
                            <span>GOOGLE NEURAL</span>
                        </button>
                    </div>
                </div>
                
                <!-- Sign Up Form -->
                <div id="signupForm" class="auth-form-content" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">NEURAL IDENTITY</label>
                        <input type="text" id="signupName" class="form-input" placeholder="Enter your neural identity">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">NEURAL EMAIL</label>
                        <input type="email" id="signupEmail" class="form-input" placeholder="Enter neural email address">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">NEURAL PASSWORD</label>
                        <div class="password-wrapper">
                            <input type="password" id="signupPassword" class="form-input" placeholder="Create neural password (min. 8 chars)">
                            <button class="password-toggle" type="button" onclick="togglePassword('signupPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">CONFIRM NEURAL PASSWORD</label>
                        <div class="password-wrapper">
                            <input type="password" id="signupConfirmPassword" class="form-input" placeholder="Confirm neural password">
                            <button class="password-toggle" type="button" onclick="togglePassword('signupConfirmPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="remember-me">
                            <input type="checkbox" id="acceptTerms" class="checkbox">
                            <span>Accept Neural Terms & Protocol</span>
                        </label>
                    </div>
                    
                    <button class="auth-btn" onclick="signUpWithEmail()">
                        <i class="fas fa-brain"></i>
                        CREATE NEURAL ACCOUNT
                    </button>
                    
                    <div class="auth-divider">
                        <span>OR CONNECT WITH</span>
                    </div>
                    
                    <div class="social-auth">
                        <button class="social-btn google-btn" onclick="signUpWithGoogle()">
                            <i class="fab fa-google social-icon"></i>
                            <span>GOOGLE NEURAL</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Interface -->
    <div id="chatContainer" class="chat-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="sidebar-logo-text">CYANIX</div>
                </div>
            </div>
            
            <div class="sidebar-content">
                <button class="new-chat-btn" onclick="newChat()">
                    <i class="fas fa-plus-circle"></i>
                    NEW NEURAL CHAT
                </button>
                
                <div class="sidebar-section">
                    <div class="sidebar-title">NEURAL ARCHITECTURES</div>
                    <div class="ai-model-selector">
                        <div class="ai-model-option active" onclick="switchAiModel('Synix')">
                            <div class="model-indicator synix"></div>
                            <div class="model-info">
                                <div class="model-name">SYNIX</div>
                                <div class="model-desc">Purple & Black Theme</div>
                            </div>
                            <div class="model-status">ACTIVE</div>
                        </div>
                        <div class="ai-model-option" onclick="switchAiModel('Axion')">
                            <div class="model-indicator axion"></div>
                            <div class="model-info">
                                <div class="model-name">AXION</div>
                                <div class="model-desc">Cyan Theme</div>
                            </div>
                            <div class="model-status">QUANTUM</div>
                        </div>
                        <div class="ai-model-option" onclick="switchAiModel('SuperNix')">
                            <div class="model-indicator supernix"></div>
                            <div class="model-info">
                                <div class="model-name">SUPERNIX</div>
                                <div class="model-desc">Dark Blue Theme</div>
                            </div>
                            <div class="model-status">PREMIUM</div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title">NEURAL TOOLS</div>
                    <button class="sidebar-btn" onclick="showNeuralSettings()">
                        <i class="fas fa-cogs"></i>
                        <span>NEURAL SETTINGS</span>
                    </button>
                    <button class="sidebar-btn" onclick="showNeuralMemory()">
                        <i class="fas fa-database"></i>
                        <span>NEURAL MEMORY</span>
                    </button>
                    <button class="sidebar-btn" onclick="showNeuralAnalytics()">
                        <i class="fas fa-chart-line"></i>
                        <span>NEURAL ANALYTICS</span>
                    </button>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title">NEURAL HISTORY</div>
                    <div class="chat-history" id="chatHistory"></div>
                </div>
            </div>
            
            <div class="user-profile" onclick="showUserMenu()">
                <div class="user-avatar" id="userAvatar">N</div>
                <div class="user-info">
                    <div class="user-name" id="userName">Neural User</div>
                    <div class="user-email" id="userEmail">neural@cyanix.ai</div>
                </div>
            </div>
        </div>
        
        <!-- Main Chat -->
        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-header-left">
                    <div class="chat-title" id="chatTitle">NEURAL CHAT INTERFACE</div>
                    <div class="model-badge" id="modelBadge">SYNIX</div>
                </div>
                <div class="chat-header-actions">
                    <button class="header-btn" onclick="clearChat()">
                        <i class="fas fa-eraser"></i>
                        CLEAR NEURAL CACHE
                    </button>
                    <button class="header-btn" onclick="exportNeuralData()">
                        <i class="fas fa-download"></i>
                        EXPORT NEURAL DATA
                    </button>
                </div>
            </div>
            
            <div class="messages-container" id="messagesContainer">
                <div id="welcomeScreen" class="welcome-screen">
                    <div class="welcome-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h1 class="welcome-title">NEURAL INTERFACE ACTIVATED</h1>
                    <p class="welcome-subtitle">
                        Welcome to CYANIX Neural Interface. Select your neural architecture and begin cognitive processing. 
                        Each model offers unique capabilities for different computational paradigms.
                    </p>
                    
                    <div class="neural-features">
                        <div class="neural-feature" onclick="useFeature('analyze')">
                            <div class="feature-icon">
                                <i class="fas fa-chart-network"></i>
                            </div>
                            <div class="feature-name">NEURAL ANALYSIS</div>
                        </div>
                        <div class="neural-feature" onclick="useFeature('code')">
                            <div class="feature-icon">
                                <i class="fas fa-code"></i>
                            </div>
                            <div class="feature-name">QUANTUM CODING</div>
                        </div>
                        <div class="neural-feature" onclick="useFeature('create')">
                            <div class="feature-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="feature-name">CREATIVE SYNTHESIS</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea 
                        id="chatInput" 
                        class="chat-input" 
                        placeholder="ENTER NEURAL QUERY..."
                        rows="1"
                        oninput="autoResizeInput(this)"
                        onkeydown="handleKeyDown(event)"
                    ></textarea>
                    <div class="input-buttons">
                        <button class="input-btn" onclick="attachNeuralFile()">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <button class="input-btn send" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== FIREBASE CONFIGURATION ====================
        const firebaseConfig = {
            apiKey: "AIzaSyAtUrEx-xIDqYZsIzWU-mG8_Fbc3s6D3Ic",
            authDomain: "nixai-d93cb.firebaseapp.com",
            projectId: "nixai-d93cb",
            storageBucket: "nixai-d93cb.firebasestorage.app",
            messagingSenderId: "120045328987",
            appId: "1:120045328987:web:01ab5651163b5c6c483d7e",
            measurementId: "G-4J7K0ZFMNT"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const analytics = firebase.analytics();
        
        // ==================== APP STATE ====================
        let currentUser = null;
        let currentChatId = null;
        let conversationHistory = [];
        let selectedAiModel = 'Synix';
        let currentTheme = 'synix';
        
        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', async () => {
            createNeuralNetwork();
            createParticles();
            await initApp();
        });

        function createNeuralNetwork() {
            const container = document.getElementById('neuralNetwork');
            const lineCount = 20;
            
            for (let i = 0; i < lineCount; i++) {
                const line = document.createElement('div');
                line.className = 'neural-line';
                
                const startX = Math.random() * 100;
                const startY = Math.random() * 100;
                const endX = Math.random() * 100;
                const endY = Math.random() * 100;
                const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
                const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
                
                line.style.width = `${length}vw`;
                line.style.height = '2px';
                line.style.left = `${startX}vw`;
                line.style.top = `${startY}vh`;
                line.style.transform = `rotate(${angle}deg)`;
                line.style.animationDelay = `${Math.random() * 4}s`;
                
                container.appendChild(line);
            }
        }

        function createParticles() {
            const container = document.getElementById('particleSystem');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const left = Math.random() * 100;
                const delay = Math.random() * 15;
                const duration = 10 + Math.random() * 20;
                const size = 2 + Math.random() * 4;
                
                particle.style.left = `${left}%`;
                particle.style.animationDelay = `${delay}s`;
                particle.style.animationDuration = `${duration}s`;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                container.appendChild(particle);
            }
        }

        function updateParticles(color) {
            document.querySelectorAll('.particle').forEach(particle => {
                particle.style.background = color;
                particle.style.boxShadow = `0 0 10px ${color}`;
            });
        }

        function updateNeuralLines(color) {
            document.querySelectorAll('.neural-line').forEach(line => {
                line.style.background = color;
            });
        }

        // ==================== THEME MANAGEMENT ====================
        function applyTheme(theme) {
            const root = document.documentElement;
            const transition = document.getElementById('modelTransition');
            
            // Show transition overlay
            transition.style.display = 'block';
            transition.style.animation = 'none';
            void transition.offsetWidth; // Trigger reflow
            transition.style.animation = 'modelTransition 1.2s cubic-bezier(0.4, 0, 0.2, 1)';
            
            // Update CSS variables based on theme
            switch(theme) {
                case 'synix':
                    root.style.setProperty('--bg-primary', 'var(--synix-bg)');
                    root.style.setProperty('--primary-color', 'var(--synix-primary)');
                    root.style.setProperty('--secondary-color', 'var(--synix-secondary)');
                    root.style.setProperty('--accent-color', 'var(--synix-accent)');
                    root.style.setProperty('--neon-glow', 'var(--synix-glow)');
                    root.style.setProperty('--grid-color', 'var(--synix-grid)');
                    root.style.setProperty('--border-color', 'var(--synix-border)');
                    root.style.setProperty('--text-color', 'var(--synix-text)');
                    updateParticles('#9d4edd');
                    updateNeuralLines('#9d4edd');
                    break;
                    
                case 'axion':
                    root.style.setProperty('--bg-primary', 'var(--axion-bg)');
                    root.style.setProperty('--primary-color', 'var(--axion-primary)');
                    root.style.setProperty('--secondary-color', 'var(--axion-secondary)');
                    root.style.setProperty('--accent-color', 'var(--axion-accent)');
                    root.style.setProperty('--neon-glow', 'var(--axion-glow)');
                    root.style.setProperty('--grid-color', 'var(--axion-grid)');
                    root.style.setProperty('--border-color', 'var(--axion-border)');
                    root.style.setProperty('--text-color', 'var(--axion-text)');
                    updateParticles('#00f3ff');
                    updateNeuralLines('#00f3ff');
                    break;
                    
                case 'supernix':
                    root.style.setProperty('--bg-primary', 'var(--supernix-bg)');
                    root.style.setProperty('--primary-color', 'var(--supernix-primary)');
                    root.style.setProperty('--secondary-color', 'var(--supernix-secondary)');
                    root.style.setProperty('--accent-color', 'var(--supernix-accent)');
                    root.style.setProperty('--neon-glow', 'var(--supernix-glow)');
                    root.style.setProperty('--grid-color', 'var(--supernix-grid)');
                    root.style.setProperty('--border-color', 'var(--supernix-border)');
                    root.style.setProperty('--text-color', 'var(--supernix-text)');
                    updateParticles('#4361ee');
                    updateNeuralLines('#4361ee');
                    break;
            }
            
            currentTheme = theme;
            
            // Hide transition overlay after animation
            setTimeout(() => {
                transition.style.display = 'none';
            }, 1200);
        }

        function previewModel(model) {
            const modelCards = document.querySelectorAll('.model-card');
            modelCards.forEach(card => card.classList.remove('active'));
            
            let theme = 'synix';
            switch(model) {
                case 'Axion': theme = 'axion'; break;
                case 'SuperNix': theme = 'supernix'; break;
            }
            
            applyTheme(theme);
            
            // Highlight selected card
            modelCards.forEach(card => {
                if (card.querySelector('.model-name').textContent === model) {
                    card.classList.add('active');
                }
            });
            
            // Update auth form style
            updateAuthFormStyle();
        }

        function updateAuthFormStyle() {
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
            const secondaryColor = getComputedStyle(document.documentElement).getPropertyValue('--secondary-color').trim();
            
            // Update form input borders
            document.querySelectorAll('.form-input').forEach(input => {
                input.style.borderColor = primaryColor;
            });
            
            // Update buttons
            document.querySelectorAll('.auth-btn').forEach(btn => {
                btn.style.background = `linear-gradient(135deg, ${primaryColor}, ${secondaryColor})`;
                btn.style.boxShadow = `0 0 30px ${primaryColor}`;
            });
        }

        // ==================== AI MODEL SWITCHING ====================
        function switchAiModel(model) {
            // Play transition sound (optional)
            playTransitionSound();
            
            // Show transition effect
            const transition = document.getElementById('modelTransition');
            transition.style.display = 'block';
            transition.style.animation = 'none';
            void transition.offsetWidth;
            transition.style.animation = 'modelTransition 1.2s cubic-bezier(0.4, 0, 0.2, 1)';
            
            selectedAiModel = model;
            
            // Apply theme based on model
            let theme = 'synix';
            switch(model) {
                case 'Axion': theme = 'axion'; break;
                case 'SuperNix': theme = 'supernix'; break;
            }
            
            setTimeout(() => {
                applyTheme(theme);
                updateModelUI();
                
                // Update active model in UI
                document.querySelectorAll('.ai-model-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.querySelector('.model-name').textContent === model) {
                        option.classList.add('active');
                    }
                });
                
                // Save preference to Firebase
                if (currentUser) {
                    db.collection('userPreferences').doc(currentUser.uid).update({
                        selectedAiModel: model,
                        theme: theme,
                        lastModelSwitch: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                showToast(`Neural architecture switched to ${model}`, 'success');
            }, 300);
        }

        function playTransitionSound() {
            // Create audio context for transition sound
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio context not supported');
            }
        }

        function updateModelUI() {
            const modelBadge = document.getElementById('modelBadge');
            if (modelBadge) {
                modelBadge.textContent = selectedAiModel;
                const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
                modelBadge.style.borderColor = primaryColor;
                modelBadge.style.color = primaryColor;
                modelBadge.style.boxShadow = `0 0 20px ${primaryColor}`;
            }
        }

        // ==================== AUTH FUNCTIONS ====================
        async function initApp() {
            try {
                console.log('Initializing CYANIX Neural Interface...');
                
                // Focus on email input
                setTimeout(() => {
                    const emailInput = document.getElementById('signinEmail');
                    if (emailInput) emailInput.focus();
                }, 500);
                
                await checkAuthState();
                
                console.log('CYANIX Neural Interface initialized successfully');
            } catch (error) {
                console.error('Error during initialization:', error);
                showToast('Welcome to CYANIX Neural Interface!', 'info');
            }
        }

        async function checkAuthState() {
            try {
                auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        await handleUserSignedIn(user);
                    } else {
                        handleUserSignedOut();
                    }
                });
            } catch (error) {
                console.error('Error checking auth state:', error);
            }
        }

        async function handleUserSignedIn(user) {
            try {
                console.log('Neural user signed in:', user.email);
                
                currentUser = {
                    uid: user.uid,
                    email: user.email,
                    name: user.displayName || user.email.split('@')[0],
                    photoURL: user.photoURL
                };
                
                // Check if user document exists
                const userDoc = await db.collection('users').doc(user.uid).get();
                
                if (!userDoc.exists) {
                    // Create new user document
                    await db.collection('users').doc(user.uid).set({
                        email: user.email,
                        name: user.displayName || user.email.split('@')[0],
                        avatar: getAvatarInitials(user.displayName || user.email),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                        neuralLevel: 1,
                        totalInteractions: 0
                    });
                    
                    // Create user preferences
                    await db.collection('userPreferences').doc(user.uid).set({
                        selectedAiModel: 'Synix',
                        theme: 'synix',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        settings: {
                            animations: true,
                            soundEffects: true,
                            autoSave: true
                        }
                    });
                    
                    showToast('Neural account created successfully!', 'success');
                } else {
                    // Update last login
                    await db.collection('users').doc(user.uid).update({
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Get user preferences
                    const prefDoc = await db.collection('userPreferences').doc(user.uid).get();
                    if (prefDoc.exists) {
                        const prefs = prefDoc.data();
                        selectedAiModel = prefs.selectedAiModel || 'Synix';
                        currentTheme = prefs.theme || 'synix';
                        applyTheme(currentTheme);
                    }
                }
                
                showChatInterface();
                await loadUserChatHistory();
                updateModelUI();
                
                showToast(`Neural link established, ${currentUser.name}!`, 'success');
                
                // Log analytics
                analytics.logEvent('user_login', {
                    method: user.providerData[0]?.providerId || 'email'
                });
                
            } catch (error) {
                console.error('Error handling user sign in:', error);
                showToast('Error loading neural data', 'error');
            }
        }

        function handleUserSignedOut() {
            currentUser = null;
            currentChatId = null;
            conversationHistory = [];
            
            const chatContainer = document.getElementById('chatContainer');
            if (chatContainer.classList.contains('active')) {
                chatContainer.classList.remove('active');
                showAuthInterface();
            }
        }

        function switchAuthTab(tab) {
            const signinForm = document.getElementById('signinForm');
            const signupForm = document.getElementById('signupForm');
            const authTabs = document.getElementById('authTabs');
            const indicator = document.querySelector('.auth-tab-indicator');
            
            if (tab === 'signin') {
                authTabs.classList.remove('signup-active');
                signinForm.style.display = 'block';
                signupForm.style.display = 'none';
                
                setTimeout(() => {
                    document.getElementById('signinEmail').focus();
                }, 10);
            } else {
                authTabs.classList.add('signup-active');
                signinForm.style.display = 'none';
                signupForm.style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('signupName').focus();
                }, 10);
            }
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggle = input.parentElement.querySelector('.password-toggle i');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.classList.remove('fa-eye');
                toggle.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                toggle.classList.remove('fa-eye-slash');
                toggle.classList.add('fa-eye');
            }
        }

        async function signInWithEmail() {
            const email = document.getElementById('signinEmail').value.trim();
            const password = document.getElementById('signinPassword').value;
            
            if (!validateEmail(email)) {
                showToast('Please enter a valid neural email address', 'error');
                return;
            }
            
            if (password.length < 6) {
                showToast('Neural password must be at least 6 characters', 'error');
                return;
            }
            
            const btn = document.querySelector('#signinForm .auth-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> INITIATING NEURAL LINK...';
            btn.disabled = true;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                showToast('Neural authentication successful!', 'success');
            } catch (error) {
                console.error('Neural sign in error:', error);
                showToast(getAuthError(error), 'error');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function signUpWithEmail() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            if (!name) {
                showToast('Please enter your neural identity', 'error');
                return;
            }
            
            if (!validateEmail(email)) {
                showToast('Please enter a valid neural email', 'error');
                return;
            }
            
            if (password.length < 8) {
                showToast('Neural password must be at least 8 characters', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showToast('Neural passwords do not match', 'error');
                return;
            }
            
            if (!acceptTerms) {
                showToast('Please accept the neural terms and protocol', 'error');
                return;
            }
            
            const btn = document.querySelector('#signupForm .auth-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> CREATING NEURAL ACCOUNT...';
            btn.disabled = true;
            
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Update user profile
                await userCredential.user.updateProfile({
                    displayName: name
                });
                
                showToast('Neural account created successfully!', 'success');
                
                setTimeout(() => {
                    switchAuthTab('signin');
                    document.getElementById('signinEmail').value = email;
                    document.getElementById('signinPassword').value = '';
                    document.getElementById('signinEmail').focus();
                    
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Neural sign up error:', error);
                showToast(getAuthError(error), 'error');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function signInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('profile');
                provider.addScope('email');
                
                await auth.signInWithPopup(provider);
            } catch (error) {
                console.error('Google neural sign in error:', error);
                showToast(getAuthError(error), 'error');
            }
        }

        function signUpWithGoogle() {
            signInWithGoogle();
        }

        async function showForgotPassword() {
            const email = prompt("Enter your neural email to reset password:");
            if (email && validateEmail(email)) {
                try {
                    await auth.sendPasswordResetEmail(email);
                    showToast('Neural password reset email sent! Check your inbox.', 'success');
                } catch (error) {
                    showToast(getAuthError(error), 'error');
                }
            } else if (email) {
                showToast('Please enter a valid neural email', 'error');
            }
        }

        // ==================== CHAT FUNCTIONS ====================
        function showChatInterface() {
            const authContainer = document.getElementById('authContainer');
            const chatContainer = document.getElementById('chatContainer');
            
            authContainer.classList.remove('show');
            
            setTimeout(() => {
                authContainer.style.display = 'none';
                chatContainer.classList.add('active');
                
                if (currentUser) {
                    document.getElementById('userName').textContent = currentUser.name;
                    document.getElementById('userEmail').textContent = currentUser.email;
                    document.getElementById('userAvatar').textContent = currentUser.photoURL ? '' : getAvatarInitials(currentUser.name);
                    
                    if (currentUser.photoURL) {
                        document.getElementById('userAvatar').style.backgroundImage = `url(${currentUser.photoURL})`;
                        document.getElementById('userAvatar').style.backgroundSize = 'cover';
                        document.getElementById('userAvatar').textContent = '';
                    }
                }
                
                setTimeout(() => {
                    const chatInput = document.getElementById('chatInput');
                    if (chatInput) chatInput.focus();
                }, 300);
                
            }, 300);
        }

        async function loadUserChatHistory() {
            if (!currentUser) return;
            
            try {
                const chatsSnapshot = await db.collection('chats')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .limit(10)
                    .get();
                
                const chatHistoryContainer = document.getElementById('chatHistory');
                chatHistoryContainer.innerHTML = '';
                
                if (!chatsSnapshot.empty) {
                    chatsSnapshot.forEach(doc => {
                        const chat = doc.data();
                        const historyItem = document.createElement('div');
                        historyItem.className = 'history-item';
                        historyItem.onclick = () => loadChat(doc.id);
                        historyItem.innerHTML = `
                            <div class="history-title">${chat.title || 'Neural Chat'}</div>
                            <div class="history-date">${formatDate(chat.createdAt?.toDate())}</div>
                        `;
                        chatHistoryContainer.appendChild(historyItem);
                    });
                }
                
            } catch (error) {
                console.log('Error loading neural chat history:', error);
            }
        }

        function newChat() {
            currentChatId = null;
            conversationHistory = [];
            
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.innerHTML = '';
            
            document.getElementById('chatTitle').textContent = 'NEW NEURAL CHAT';
            
            const welcomeScreen = document.createElement('div');
            welcomeScreen.id = 'welcomeScreen';
            welcomeScreen.className = 'welcome-screen';
            welcomeScreen.innerHTML = `
                <div class="welcome-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h1 class="welcome-title">NEURAL INTERFACE ACTIVATED</h1>
                <p class="welcome-subtitle">
                    Welcome to CYANIX Neural Interface. Select your neural architecture and begin cognitive processing. 
                    Each model offers unique capabilities for different computational paradigms.
                </p>
                
                <div class="neural-features">
                    <div class="neural-feature" onclick="useFeature('analyze')">
                        <div class="feature-icon">
                            <i class="fas fa-chart-network"></i>
                        </div>
                        <div class="feature-name">NEURAL ANALYSIS</div>
                    </div>
                    <div class="neural-feature" onclick="useFeature('code')">
                        <div class="feature-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="feature-name">QUANTUM CODING</div>
                    </div>
                    <div class="neural-feature" onclick="useFeature('create')">
                        <div class="feature-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="feature-name">CREATIVE SYNTHESIS</div>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(welcomeScreen);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            showToast('New neural chat initialized', 'info');
        }

        function useFeature(feature) {
            const examples = {
                analyze: "Perform neural analysis on quantum computing trends. Include market impact, technological barriers, and future predictions with data visualization.",
                code: "Generate a quantum-inspired neural network architecture in Python. Include tensor operations, optimization algorithms, and performance benchmarks.",
                create: "Create a futuristic cyberpunk city concept with neural enhancements. Include architectural elements, societal structures, and technological integrations."
            };

            const input = document.getElementById('chatInput');
            input.value = examples[feature];
            autoResizeInput(input);
            input.focus();
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                showToast('Please enter a neural query', 'warning');
                return;
            }
            
            const welcomeScreen = document.getElementById('welcomeScreen');
            if (welcomeScreen) {
                welcomeScreen.remove();
            }
            
            addMessageToUI(message, 'user');
            conversationHistory.push({ role: 'user', content: message });
            
            input.value = '';
            autoResizeInput(input);
            
            showTypingIndicator();
            
            try {
                if (!currentChatId && currentUser) {
                    // Create new chat document
                    const chatRef = await db.collection('chats').add({
                        userId: currentUser.uid,
                        title: message.substring(0, 60) + (message.length > 60 ? '...' : ''),
                        aiModelUsed: selectedAiModel,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        messageCount: 1
                    });
                    
                    currentChatId = chatRef.id;
                    document.getElementById('chatTitle').textContent = message.substring(0, 40) + (message.length > 40 ? '...' : '');
                    
                    await loadUserChatHistory();
                }
                
                if (currentChatId && currentUser) {
                    // Save user message
                    await db.collection('chats').doc(currentChatId).collection('messages').add({
                        content: message,
                        role: 'user',
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update chat stats
                    await db.collection('chats').doc(currentChatId).update({
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        messageCount: firebase.firestore.FieldValue.increment(1)
                    });
                }
                
                // Get AI response
                let aiResponse = await getAIResponse(message);
                
                hideTypingIndicator();
                
                addMessageToUI(aiResponse, 'assistant');
                conversationHistory.push({ role: 'assistant', content: aiResponse });
                
                if (currentChatId && currentUser) {
                    // Save AI response
                    await db.collection('chats').doc(currentChatId).collection('messages').add({
                        content: aiResponse,
                        role: 'assistant',
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update user stats
                    await db.collection('users').doc(currentUser.uid).update({
                        totalInteractions: firebase.firestore.FieldValue.increment(1),
                        lastInteraction: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                // Log analytics
                analytics.logEvent('chat_message_sent', {
                    model: selectedAiModel,
                    message_length: message.length
                });
                
            } catch (error) {
                console.error('Error sending neural message:', error);
                hideTypingIndicator();
                
                const fallbackResponse = "Neural processing error encountered. Please retry your query.";
                addMessageToUI(fallbackResponse, 'assistant');
                conversationHistory.push({ role: 'assistant', content: fallbackResponse });
                
                showToast('Neural response error', 'error');
            }
        }

        async function getAIResponse(message) {
            // Simulate AI processing with different responses per model
            await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 800));
            
            const responses = {
                Synix: `**SYNIX ANALYSIS COMPLETE**\n\n**Input Processing:** "${message.substring(0, 60)}"\n**Processing Time:** 0.6ms\n**Neural Nodes:** 512\n\n**PURPLE WAVE OUTPUT:**\n\n\`\`\`python
class NeuralProcessor:
    def __init__(self):
        self.model = "Synix"
        self.color_theme = "Purple & Black"
        
    def analyze(self, query):
        # Purple neural processing
        insights = self.neural_analysis(query)
        return self.format_insights(insights)
\`\`\`\n\n**PURPLE INSIGHTS:**\n? Primary pattern identified\n? Alternative pathways generated\n? Risk assessment complete\n\n**NEXT ACTION:** Request enhanced analysis or switch neural mode.`,
                
                Axion: `**AXION QUANTUM PROCESSING**\n\n**Quantum Input:** "${message.substring(0, 70)}"\n**Processing Speed:** 0.3ms\n**Quantum Bits:** 1,024\n\n**CYAN QUANTUM STREAM:**\n\n? **QUANTUM STATE:** Superposition active\n? **NEURAL PATHS:** Multiple dimensions\n? **ANALYSIS DEPTH:** Quantum-level\n\n\`\`\`quantum
BEGIN CYAN_PROCESSING
    SET_QUANTUM_BITS = 1024
    ACTIVATE_SUPERPOSITION = TRUE
    INITIATE_PARALLEL_PROCESSING = TRUE
    
    FOR quantum_layer IN range(8):
        PROCESS_QUANTUM_LAYER(quantum_layer)
    
    MERGE_QUANTUM_OUTPUTS()
    OPTIMIZE_FOR_HUMAN_READING()
END CYAN_PROCESSING
\`\`\`\n\n**CYAN RECOMMENDATIONS:**\n1. Primary quantum solution\n2. Alternative temporal approaches\n3. Risk mitigation quantum protocols\n\n**QUERY ENHANCEMENT:** Specify quantum parameters or request temporal analysis.`,
                
                SuperNix: `**SUPERNIX QUANTUM MATRIX**\n\n**Dimensional Input:** "${message.substring(0, 80)}"\n**Processing Time:** 0.1ms\n**Neural Connections:** 65,536\n\n**DARK BLUE QUANTUM OUTPUT:**\n\n? **DIMENSIONS:** 11D processing active\n? **SPEED:** Light-speed computation\n? **ENTANGLEMENT:** All solutions linked\n\n**QUANTUM CODE MATRIX:**\n\`\`\`supernix
MATRIX_PROCESSING = {
    "dimensional_layers": 11,
    "neural_density": "ultra_high",
    "processing_mode": "quantum_premium",
    "output_format": "human_enhanced"
}

for dimension in range(MATRIX_PROCESSING["dimensional_layers"]):
    quantum_process(dimension)
    generate_solutions(dimension)

final_output = merge_all_dimensions()
apply_temporal_optimization(final_output)
\`\`\`\n\n**DARK BLUE INSIGHTS:**\n1. Temporal optimization available\n2. Resource efficiency: 96%\n3. Scalability: Infinite dimensions\n\n**MATRIX QUERY:** Request specific dimensional focus.`
            };
            
            return responses[selectedAiModel] || responses.Synix;
        }

        function addMessageToUI(content, sender) {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = `message ${sender}`;
            
            const actions = sender === 'assistant' ? `
                <div class="message-actions">
                    <button class="message-action-btn" onclick="copyMessage('${content.replace(/'/g, "\\'")}')">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="message-action-btn" onclick="enhanceMessage(this)">
                        <i class="fas fa-magic"></i>
                    </button>
                </div>
            ` : '';
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-header-left">
                        <div class="message-avatar ${sender}">
                            ${sender === 'user' ? (currentUser?.name?.charAt(0) || 'N') : selectedAiModel.charAt(0)}
                        </div>
                        <div class="message-sender">
                            ${sender === 'user' ? (currentUser?.name || 'Neural User') : selectedAiModel}
                        </div>
                    </div>
                    ${actions}
                </div>
                <div class="message-content">${formatMessage(content)}</div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            
            // Add message animation
            messageDiv.style.animation = 'fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
        }

        // ==================== FEATURE FUNCTIONS ====================
        function showNeuralSettings() {
            showToast('Neural Settings Panel - Under Development', 'info');
        }

        function showNeuralMemory() {
            showToast('Neural Memory Management - Coming Soon', 'info');
        }

        function showNeuralAnalytics() {
            showToast('Neural Analytics Dashboard - In Progress', 'info');
        }

        function attachNeuralFile() {
            showToast('Neural File Attachment System - Developing', 'info');
        }

        function exportNeuralData() {
            if (conversationHistory.length === 0) {
                showToast('No neural data to export', 'warning');
                return;
            }
            
            let exportText = `CYANIX NEURAL DATA EXPORT\n`;
            exportText += `Date: ${new Date().toLocaleString()}\n`;
            exportText += `User: ${currentUser?.name || 'Neural User'}\n`;
            exportText += `Model: ${selectedAiModel}\n`;
            exportText += `Theme: ${currentTheme}\n`;
            exportText += 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT\n\n';
            
            conversationHistory.forEach((msg, index) => {
                exportText += `${msg.role === 'user' ? 'NEURAL USER' : selectedAiModel}:\n`;
                exportText += `${msg.content}\n\n`;
                exportText += ''.repeat(40) + '\n\n';
            });

            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cyanix-neural-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showToast('Neural data exported successfully!', 'success');
        }

        function enhanceMessage(button) {
            const messageDiv = button.closest('.message');
            const content = messageDiv.querySelector('.message-content');
            
            // Add enhancement effect
            content.style.animation = 'pulse 0.5s';
            
            setTimeout(() => {
                content.innerHTML = content.innerHTML.replace(
                    /\*\*(.*?)\*\*/g,
                    '<strong class="enhanced">$1</strong>'
                );
                showToast('Message enhanced with neural processing', 'success');
            }, 500);
        }

        // ==================== UTILITY FUNCTIONS ====================
        function autoResizeInput(textarea) {
            textarea.style.height = 'auto';
            const newHeight = Math.min(textarea.scrollHeight, 200);
            textarea.style.height = newHeight + 'px';
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function formatMessage(text) {
            return text
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>')
                .replace(/```([\s\S]*?)```/g, '<pre>$1</pre>');
        }

        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">
                    ${type === 'success' ? '<i class="fas fa-check-circle"></i>' : 
                      type === 'error' ? '<i class="fas fa-exclamation-circle"></i>' : 
                      type === 'warning' ? '<i class="fas fa-exclamation-triangle"></i>' :
                      '<i class="fas fa-info-circle"></i>'}
                </div>
                <div class="toast-message">${message}</div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 500);
            }, 5000);
        }

        function validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function getAvatarInitials(name) {
            if (!name) return 'N';
            return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        }

        function getAuthError(error) {
            switch (error.code) {
                case 'auth/invalid-email':
                    return 'Invalid neural email format';
                case 'auth/user-disabled':
                    return 'Neural account disabled';
                case 'auth/user-not-found':
                    return 'Neural account not found';
                case 'auth/wrong-password':
                    return 'Incorrect neural password';
                case 'auth/email-already-in-use':
                    return 'Neural email already registered';
                case 'auth/weak-password':
                    return 'Neural password too weak';
                case 'auth/too-many-requests':
                    return 'Too many neural attempts';
                default:
                    return error.message || 'Neural authentication error';
            }
        }

        function formatDate(date) {
            if (!date) return 'Recent';
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            if (days < 7) return `${days}d ago`;
            return date.toLocaleDateString();
        }

        async function showUserMenu() {
            const action = confirm(`Neural User: ${currentUser?.name}\n\nSign out or manage neural settings?`);
            if (action) {
                try {
                    await auth.signOut();
                    showToast('Neural session terminated', 'success');
                } catch (error) {
                    showToast('Error terminating neural session', 'error');
                }
            } else {
                showNeuralSettings();
            }
        }

        function clearChat() {
            if (confirm('Clear neural chat cache? This cannot be undone.')) {
                newChat();
            }
        }

        function showTypingIndicator() {
            const container = document.getElementById('messagesContainer');
            const typingDiv = document.createElement('div');
            
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-header-left">
                        <div class="message-avatar assistant">${selectedAiModel.charAt(0)}</div>
                        <div class="message-sender">${selectedAiModel}</div>
                    </div>
                </div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }

        function copyMessage(text) {
            const cleanText = text.replace(/\*\*/g, '').replace(/\*/g, '').replace(/`/g, '');
            navigator.clipboard.writeText(cleanText)
                .then(() => showToast('Neural message copied!', 'success'))
                .catch(() => showToast('Failed to copy neural message', 'error'));
        }

        function showAuthInterface() {
            const authContainer = document.getElementById('authContainer');
            authContainer.classList.add('show');
            
            setTimeout(() => {
                const emailInput = document.getElementById('signinEmail');
                if (emailInput) emailInput.focus();
            }, 300);
        }
    </script>
</body>
</html>
